# WASP2 Singularity Definition File
# Builds a Singularity/Apptainer container from the Docker image
#
# Build: singularity build wasp2.sif Singularity.def
# Or pull directly: singularity pull docker://jaureguy760/wasp2:latest

Bootstrap: docker
From: jaureguy760/wasp2:latest

%labels
    Author Jeff Jaureguy <jeffpjaureguy@gmail.com>
    Version 1.2.0
    Description WASP2: Allele-specific analysis of NGS data with Rust acceleration

%help
    WASP2 - Allele-Specific Analysis Pipeline

    This container provides tools for allele-specific analysis of NGS data:

    CLI Tools (each has subcommands - use --help for details):
      wasp2-count    - Allele counting (count-variants, count-variants-sc)
      wasp2-map      - WASP mapping filter (make-reads, filter-remapped)
      wasp2-analyze  - Statistical analysis (find-imbalance, find-imbalance-sc, compare-imbalance)

    Usage Examples:
      singularity exec wasp2.sif wasp2-count --help
      singularity exec wasp2.sif wasp2-map make-reads input.bam variants.vcf.gz
      singularity exec wasp2.sif wasp2-analyze find-imbalance counts.tsv -o results.tsv

    Nextflow Integration:
      nextflow run main.nf -profile singularity

    Documentation: https://github.com/Jaureguy760/WASP2-final

%environment
    export LC_ALL=C
    export PATH="/usr/local/bin:$PATH"

%runscript
    exec "$@"

%test
    wasp2-count --version
    wasp2-map --version
    wasp2-analyze --version
    python -c "import wasp2_rust; print('Rust extension OK')"
    echo "All tests passed!"
