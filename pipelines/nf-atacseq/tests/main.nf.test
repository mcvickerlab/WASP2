nextflow_pipeline {

    name "Test nf-atacseq Pipeline"
    script "../main.nf"

    tag "pipeline"
    tag "nf-atacseq"

    test("Should run stub-run mode for workflow validation") {

        tag "ci_stub"
        options "-stub"

        when {
            params {
                outdir = "$outputDir/results"
            }
        }

        then {
            assert workflow.success
        }
    }

    test("Should fail with missing required inputs") {

        options "-stub"

        when {
            params {
                input  = null
                fasta  = null
                outdir = "$outputDir/results"
            }
        }

        then {
            assert workflow.failed
        }
    }
}
