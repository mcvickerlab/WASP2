% LaTeX Template for WASP2 Figures
% For Nature Methods submission
% Generated: December 3, 2025

\documentclass{article}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{siunitx}

% Nature Methods typically uses single column (88mm) or double column (180mm)
% Set your document class accordingly

\begin{document}

% ============================================================================
% MAIN TEXT FIGURES
% ============================================================================

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/figure1_runtime_comparison.pdf}
    \caption{\textbf{WASP2 runtime performance comparison.}
    Bar chart comparing total runtime of WASP1 (Python, \SI{1541}{\second}),
    STAR+WASP (C++, \SI{332}{\second}), and WASP2 Rust-accelerated components
    (\SI{30}{\second}) on HG00731 RNA-seq dataset (\num{112.5e6} reads, 8 threads).
    WASP2 demonstrates 2.77$\times$ speedup over WASP1 and 51$\times$ improved
    read processing throughput (3.77M reads/s vs 0.07M reads/s).}
    \label{fig:runtime_comparison}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/figure4_variant_coverage.pdf}
    \caption{\textbf{WASP2 variant processing statistics.}
    \textbf{(a)} Read distribution showing 88.8\% of reads have no variants
    and are kept directly (\num{99.9e6} reads), while 11.2\% overlap variants
    and require remapping (\num{12.6e6} reads).
    \textbf{(b)} Variant processing pipeline showing \num{2.21e6} VCF variants,
    \num{6.89e6} unique read-variant overlaps, and \num{3.07e6} haplotypes
    generated for allele-specific analysis. The 2:1 ratio of haplotypes to FASTQ
    reads confirms proper paired-end read handling.}
    \label{fig:variant_stats}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/figure5_gatk_comparison.pdf}
    \caption{\textbf{GATK ASEReadCounter accuracy comparison with simulation ground truth.}
    Scatter plots comparing GATK-predicted allelic ratios to known ground truth
    (reference ratio = 0.5 for all heterozygous 0|1 variants) across SNPs,
    insertions (INS), and deletions (DEL). GATK shows accurate performance for
    SNPs but systematic errors for INDEL variants (ratios deviate significantly
    from expected 0.5), highlighting the need for robust INDEL handling in
    allele-specific read filtering pipelines. Diagonal dashed line indicates
    perfect agreement.}
    \label{fig:gatk_comparison}
\end{figure}

% ============================================================================
% SUPPLEMENTARY FIGURES
% ============================================================================

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\textwidth]{figures/figure2_pipeline_breakdown.pdf}
    \caption{\textbf{WASP2 unified pipeline execution time breakdown.}
    Horizontal bar chart showing time distribution across pipeline steps.
    STAR alignment steps (initial alignment: \SI{476}{\second}, 85.6\%;
    remapping: \SI{48}{\second}, 8.6\%) dominate total runtime, while
    Rust-accelerated WASP2 components (find intersecting: \SI{17}{\second}, 3.0\%;
    filter remapped: \SI{13}{\second}, 2.3\%) account for only 5.3\% of
    total pipeline time, demonstrating their computational efficiency.}
    \label{fig:pipeline_breakdown}
\end{figure}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.45\textwidth]{figures/figure3_throughput_comparison.pdf}
    \caption{\textbf{Read processing throughput comparison.}
    Bar chart showing reads per second processed by WASP1 (0.07M reads/s),
    STAR+WASP (0.34M reads/s), and WASP2 (3.77M reads/s). WASP2 achieves
    51$\times$ higher throughput than WASP1 and 11$\times$ higher than
    STAR+WASP, enabling practical analysis of large-scale RNA-seq datasets.}
    \label{fig:throughput}
\end{figure}

% ============================================================================
% SUPPLEMENTARY TABLE
% ============================================================================

\begin{table}[htbp]
    \centering
    \caption{\textbf{WASP2 pipeline statistics and performance metrics.}}
    \label{tab:stats}
    \begin{tabular}{lr}
        \toprule
        \textbf{Metric} & \textbf{Value} \\
        \midrule
        \multicolumn{2}{l}{\textit{Dataset Statistics (HG00731)}} \\
        Total BAM reads & \num{112509428} \\
        VCF variants (heterozygous) & \num{2206785} \\
        Reads at variants (to remap) & \num{12627534} \\
        Reads without variants (keep) & \num{99881894} \\
        Unique read-variant overlaps & \num{6890185} \\
        Haplotypes generated & \num{3068926} \\
        R1 FASTQ reads & \num{1534463} \\
        R2 FASTQ reads & \num{1534463} \\
        \midrule
        \multicolumn{2}{l}{\textit{Runtime Performance (8 threads)}} \\
        WASP1 total runtime & \SI{1541.13}{\second} \\
        STAR+WASP total runtime & \SI{331.67}{\second} \\
        WASP2 Rust components runtime & \SI{29.85}{\second} \\
        WASP2 speedup vs WASP1 & 2.77$\times$ \\
        WASP2 speedup vs STAR+WASP & 0.59$\times$ \\
        \midrule
        \multicolumn{2}{l}{\textit{WASP2 Pipeline Breakdown}} \\
        STAR initial alignment & \SI{475.95}{\second} \\
        Find intersecting variants (Rust) & \SI{16.88}{\second} \\
        STAR remapping & \SI{48.03}{\second} \\
        Filter remapped reads (Rust) & \SI{12.97}{\second} \\
        \bottomrule
    \end{tabular}
\end{table}

% ============================================================================
% EXAMPLE REFERENCES TO FIGURES IN TEXT
% ============================================================================

% Example usage in text:
%
% WASP2 demonstrates substantial performance improvements over existing
% implementations (Figure~\ref{fig:runtime_comparison}). The Rust-accelerated
% components complete allele-specific read filtering in \SI{30}{\second},
% representing a 2.77$\times$ speedup over the Python-based WASP1 implementation.
%
% Analysis of \num{112.5e6} reads from sample HG00731 shows that 88.8\% of
% reads have no overlapping variants and are processed directly, while 11.2\%
% require remapping (Figure~\ref{fig:variant_stats}a). The pipeline efficiently
% generates \num{3.07e6} haplotypes from \num{6.89e6} read-variant overlaps
% across \num{2.21e6} heterozygous sites (Figure~\ref{fig:variant_stats}b).
%
% Comparison with GATK's ASEReadCounter reveals limitations in existing tools
% for handling INDEL variants (Figure~\ref{fig:gatk_comparison}). While GATK
% accurately quantifies SNPs, it shows systematic errors for insertions and
% deletions, motivating WASP2's comprehensive INDEL support.

\end{document}
